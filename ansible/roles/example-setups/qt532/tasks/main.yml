- name: Add PPA
  apt_repository:
    repo: "{{ item }}"
  with_items: qt532_apt_ppas

- name: install APT packages
  apt:
    name: "{{ item }}"
    update_cache: yes
    state: latest
    cache_valid_time: 86400
  with_items: qt532_apt_packages

- name: Copy Prepare Script
  template:
    src: 'qt532.sh.j2'
    dest: "{{ buildbot_slave_prepare_dir }}/{{ qt532_tag }}.sh"
    owner: '{{ buildbot_slave_user }}'
    group: '{{ buildbot_slave_user }}'
    mode: 'u+x'
  notify:
  - reconfig buildslave

- name: Store Facts
  set_fact:
    buildbot_slave_setups: "{{ buildbot_slave_setups }} + ['{{ qt532_tag }}']"
  tags:
  - facts
